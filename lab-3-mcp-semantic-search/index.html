
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Microsoft Foundry Agent Services with MCP Workshop.">
      
      
        <meta name="author" content="Dave Glover">
      
      
        <link rel="canonical" href="https://microsoft.github.io/aitour26-WRK540-unlock-your-agents-potential-with-model-context-protocol/lab-3-mcp-semantic-search/">
      
      
        <link rel="prev" href="../lab-2-start-the-agent/">
      
      
        <link rel="next" href="../observability-overview/">
      
      
        
          <link rel="alternate" href="./" hreflang="en">
        
          <link rel="alternate" href="../es/lab-3-mcp-semantic-search/" hreflang="es">
        
      
      
      <link rel="icon" href="../media/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Lab 3 Semantic Search - Unlock your Agents Potential with MCP</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/custom.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
   <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="pink">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#what-youll-learn" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Unlock your Agents Potential with MCP" class="md-header__button md-logo" aria-label="Unlock your Agents Potential with MCP" data-md-component="logo">
      
  <img src="../media/favicon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Unlock your Agents Potential with MCP
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab 3 Semantic Search
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="pink"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 2c-1.82 0-3.53.5-5 1.35C8 5.08 10 8.3 10 12s-2 6.92-5 8.65C6.47 21.5 8.18 22 10 22a10 10 0 0 0 10-10A10 10 0 0 0 10 2"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="amber" data-md-color-accent="cyan"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="./" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../es/lab-3-mcp-semantic-search/" hreflang="es" class="md-select__link">
              EspaÃ±ol
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/microsoft/aitour26-WRK540-unlock-your-agents-potential-with-model-context-protocol" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Unlock your Agents Potential with MCP
  </div>
</a>
      </div>
    
  </nav>
  
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Unlock your Agents Potential with MCP" class="md-nav__button md-logo" aria-label="Unlock your Agents Potential with MCP" data-md-component="logo">
      
  <img src="../media/favicon.png" alt="logo">

    </a>
    Unlock your Agents Potential with MCP
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/microsoft/aitour26-WRK540-unlock-your-agents-potential-with-model-context-protocol" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Unlock your Agents Potential with MCP
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Workshop Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../navigating-the-workshop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Workshop Navigation
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Open the Workshop
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Agent Services Labs
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Agent Services Labs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agent-service-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AI Foundry Agent Services
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab-1-agent-instructions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 1 Agent Instructions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab-2-start-the-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 2 Start your Agent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Lab 3 Semantic Search
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 3 Semantic Search
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-youll-learn" class="md-nav__link">
    <span class="md-ellipsis">
      
        What You'll Learn
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-exercise" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lab Exercise
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stop-the-agent-app" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stop the Agent App
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implement-semantic-search" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implement Semantic Search
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implement-semantic-search_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implement Semantic Search
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#review-the-agent-instructions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Review the Agent Instructions
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#start-the-agent-app-with-the-semantic-search-tool" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start the Agent App with the Semantic Search Tool
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#write-an-executive-report" class="md-nav__link">
    <span class="md-ellipsis">
      
        Write an Executive Report
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leave-the-agent-app-running" class="md-nav__link">
    <span class="md-ellipsis">
      
        Leave the Agent App Running
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Observability Labs
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Observability Labs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Observability Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab-5-monitoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 5 Service Monitoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab-6-tracing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 6 Understand Tracing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../star-and-connect/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Star and Connect
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab-7-finishing-up/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Finishing Up
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../summary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Summary
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Resources
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Bonus content
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Bonus content
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab-4-secure-agent-data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Securing Agent Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab-7-local-tracing-with-aspire/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Local Tracing with Aspire
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-youll-learn" class="md-nav__link">
    <span class="md-ellipsis">
      
        What You'll Learn
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-exercise" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lab Exercise
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stop-the-agent-app" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stop the Agent App
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implement-semantic-search" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implement Semantic Search
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implement-semantic-search_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implement Semantic Search
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#review-the-agent-instructions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Review the Agent Instructions
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#start-the-agent-app-with-the-semantic-search-tool" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start the Agent App with the Semantic Search Tool
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#write-an-executive-report" class="md-nav__link">
    <span class="md-ellipsis">
      
        Write an Executive Report
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leave-the-agent-app-running" class="md-nav__link">
    <span class="md-ellipsis">
      
        Leave the Agent App Running
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Lab 3 Semantic Search</h1>

<h2 id="what-youll-learn">What You'll Learn<a class="headerlink" href="#what-youll-learn" title="Permanent link">&para;</a></h2>
<p>In this lab, you enable semantic search capabilities in the Azure AI Agent using the MCP Server and the PostgreSQL database with the <a href="https://github.com/pgvector/pgvector" target="_blank">PostgreSQL Vector</a> extension enabled.</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>This lab upgrades the Azure AI Agent with semantic search using the MCP Server and PostgreSQL. </p>
<p>All of Zava's product names and descriptions have been converted to vectors with the OpenAI embedding model (text-embedding-3-small) and stored in the database. This enables the agent to understand user intent and provide more accurate responses.</p>
<details class="note">
<summary>ðŸš€ For Developers: How does PostgreSQL Semantic Search work?</summary>
<h3 id="vectorizing-the-product-descriptions-and-names">Vectorizing the Product Descriptions and Names<a class="headerlink" href="#vectorizing-the-product-descriptions-and-names" title="Permanent link">&para;</a></h3>
<p>To learn more about how Zava product names and descriptions were vectorized, see the <a href="https://github.com/microsoft/aitour26-WRK540-unlock-your-agents-potential-with-model-context-protocol/tree/main/data/database" target="_blank">Zava DIY PostgreSQL Database Generator README</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Python</label><label for="__tabbed_1_2">C#</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<h3 id="llm-calls-the-mcp-server-tool">LLM calls the MCP Server Tool<a class="headerlink" href="#llm-calls-the-mcp-server-tool" title="Permanent link">&para;</a></h3>
<p>Based on the user's query and the instructions provided, the LLM decides to call the MCP Server tool <code>semantic_search_products</code> to find relevant products.</p>
<p>The following sequence of events occurs:</p>
<ol>
<li>The MCP tool <code>semantic_search_products</code> is invoked with the user's query description.</li>
<li>The MCP server generates a vector for the query using the OpenAI embedding model (text-embedding-3-small). See the code for vectorizing the query is in the <code>generate_query_embedding</code> method.</li>
<li>The MCP server then performs a semantic search against the PostgreSQL database to find products with similar vectors.</li>
</ol>
<h3 id="postgresql-semantic-search-overview">PostgreSQL Semantic Search Overview<a class="headerlink" href="#postgresql-semantic-search-overview" title="Permanent link">&para;</a></h3>
<p>The <code>semantic_search_products</code> MCP Server tool then executes a SQL query that uses the vectorized query to find the most similar product vectors in the database. The SQL query uses the <code>&lt;-&gt;</code> operator provided by the pgvector extension to calculate the distance between vectors.</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">search_products_by_similarity</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">query_embedding</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> 
        <span class="n">rls_user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
        <span class="n">max_rows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> 
        <span class="n">similarity_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">30.0</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="o">...</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            SELECT </span>
<span class="s2">                p.*,</span>
<span class="s2">                (pde.description_embedding &lt;=&gt; $1::vector) as similarity_distance</span>
<span class="s2">            FROM </span><span class="si">{</span><span class="n">SCHEMA_NAME</span><span class="si">}</span><span class="s2">.product_description_embeddings pde</span>
<span class="s2">            JOIN </span><span class="si">{</span><span class="n">SCHEMA_NAME</span><span class="si">}</span><span class="s2">.products p ON pde.product_id = p.product_id</span>
<span class="s2">            WHERE (pde.description_embedding &lt;=&gt; $1::vector) &lt;= $3</span>
<span class="s2">            ORDER BY similarity_distance</span>
<span class="s2">            LIMIT $2</span>
<span class="s2">        &quot;&quot;&quot;</span>

        <span class="n">rows</span> <span class="o">=</span> <span class="k">await</span> <span class="n">conn</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">embedding_str</span><span class="p">,</span> <span class="n">max_rows</span><span class="p">,</span> <span class="n">distance_threshold</span><span class="p">)</span>
        <span class="o">...</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<h3 id="llm-calls-the-mcp-server-tool_1">LLM calls the MCP Server Tool<a class="headerlink" href="#llm-calls-the-mcp-server-tool_1" title="Permanent link">&para;</a></h3>
<p>Based on the user's query and the instructions provided, the LLM decides to call the MCP Server tool <code>semantic_search_products</code> to find relevant products.</p>
<p>The following sequence of events occurs:</p>
<ol>
<li>The MCP tool <code>semantic_search_products</code> is invoked with the user's query description.</li>
<li>The MCP server generates a vector for the query using the OpenAI embedding model (text-embedding-3-small). See <code>GenerateVectorAsync</code> method in the <code>EmbeddingGeneratorExtensions.cs</code> file.</li>
<li>The MCP server then performs a semantic search against the PostgreSQL database to find products with similar vectors.</li>
</ol>
<h3 id="postgresql-semantic-search-overview_1">PostgreSQL Semantic Search Overview<a class="headerlink" href="#postgresql-semantic-search-overview_1" title="Permanent link">&para;</a></h3>
<p>The <code>semantic_search_products</code> MCP Server tool then executes a SQL query that uses the vectorized query to find the most similar product vectors in the database. The SQL query uses the <code>&lt;-&gt;</code> operator provided by the pgvector extension to calculate the distance between vectors.</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="n">IEnumerable</span><span class="o">&lt;</span><span class="n">SemanticSearchResult</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">SemanticSearchProductsAsync</span><span class="p">(</span>
<span class="p">...</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="nn">var</span><span class="w"> </span><span class="n">searchCmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">NpgsqlCommand</span><span class="p">(</span><span class="s">&quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">SELECT</span><span class="w"> </span>
<span class="w">        </span><span class="n">p</span><span class="p">.</span><span class="o">*</span><span class="p">,</span>
<span class="w">        </span><span class="p">(</span><span class="n">pde</span><span class="p">.</span><span class="n">description_embedding</span><span class="w"> </span><span class="o">&lt;=&gt;</span><span class="w"> </span><span class="err">$</span><span class="mi">1</span><span class="p">::</span><span class="n">vector</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">similarity_distance</span>
<span class="w">    </span><span class="n">FROM</span><span class="w"> </span><span class="n">retail</span><span class="p">.</span><span class="n">product_description_embeddings</span><span class="w"> </span><span class="n">pde</span>
<span class="w">    </span><span class="n">JOIN</span><span class="w"> </span><span class="n">retail</span><span class="p">.</span><span class="n">products</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">ON</span><span class="w"> </span><span class="n">pde</span><span class="p">.</span><span class="n">product_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">product_id</span>
<span class="w">    </span><span class="n">WHERE</span><span class="w"> </span><span class="p">(</span><span class="n">pde</span><span class="p">.</span><span class="n">description_embedding</span><span class="w"> </span><span class="o">&lt;=&gt;</span><span class="w"> </span><span class="err">$</span><span class="mi">1</span><span class="p">::</span><span class="n">vector</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="err">$</span><span class="mi">3</span>
<span class="w">    </span><span class="n">ORDER</span><span class="w"> </span><span class="n">BY</span><span class="w"> </span><span class="n">similarity_distance</span>
<span class="w">    </span><span class="n">LIMIT</span><span class="w"> </span><span class="err">$</span><span class="mi">2</span>
<span class="w">    </span><span class="s">&quot;&quot;&quot;, connection);</span>
<span class="w">    </span><span class="n">searchCmd</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">AddWithValue</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Vector</span><span class="p">(</span><span class="n">embeddings</span><span class="p">));</span>
<span class="w">    </span><span class="n">searchCmd</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">AddWithValue</span><span class="p">(</span><span class="n">maxRows</span><span class="p">);</span>
<span class="w">    </span><span class="n">searchCmd</span><span class="p">.</span><span class="n">Parameters</span><span class="p">.</span><span class="n">AddWithValue</span><span class="p">(</span><span class="n">distanceThreshold</span><span class="p">);</span>

<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="nn">var</span><span class="w"> </span><span class="n">reader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">searchCmd</span><span class="p">.</span><span class="n">ExecuteReaderAsync</span><span class="p">();</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">SemanticSearchResult</span><span class="o">&gt;</span><span class="p">();</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<h2 id="lab-exercise">Lab Exercise<a class="headerlink" href="#lab-exercise" title="Permanent link">&para;</a></h2>
<p>From the previous lab you can ask the agent questions about sales data, but it was limited to exact matches. In this lab, you extend the agent's capabilities by implementing semantic search using the Model Context Protocol (MCP). This will allow the agent to understand and respond to queries that are not exact matches, improving its ability to assist users with more complex questions.</p>
<ol>
<li>Paste the following question into the Web Chat tab in your browser:</li>
</ol>
<div class="highlight"><pre><span></span><code>What 18 amp circuit breakers do we sell?
</code></pre></div>
<p>The agent cannot find matching products because it's performing text matching. It will respond that no products were found and may suggest trying different search terms.</p>
<h2 id="stop-the-agent-app">Stop the Agent App<a class="headerlink" href="#stop-the-agent-app" title="Permanent link">&para;</a></h2>
<p>From VS Code, stop the agent app by pressing <kbd>Shift + F5</kbd>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Python</label><label for="__tabbed_2_2">C#</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<h2 id="implement-semantic-search">Implement Semantic Search<a class="headerlink" href="#implement-semantic-search" title="Permanent link">&para;</a></h2>
<p>In this section, you will implement semantic search using the Model Context Protocol (MCP) to enhance the agent's capabilities.</p>
<ol>
<li>Select the <strong>Explorer</strong> icon from the sidebar of VS Code.</li>
<li>Navigate to the <code>mcp_server/sales_analysis</code> folder.</li>
<li>
<p>Open the <code>sales_analysis.py</code> file.</p>
<p>This file contains the MCP tools for the sales analysis agent, including the semantic search tool.</p>
<p><a class="glightbox" href="../media/vs-code-open-mcp-server.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Open MCP Server Tools in VS Code" src="../media/vs-code-open-mcp-server.png" /></a></p>
</li>
<li>
<p>Scroll down to around line 70 and look for the <code>semantic_search_products</code> method. This method is responsible for performing semantic search on the sales data. You'll notice the <strong>@mcp.tool()</strong> decorator is commented out. This decorator is used to register the method as an MCP tool, allowing it to be called by the agent.</p>
</li>
<li>
<p><strong>Remove</strong> the <code>#</code> symbol and following space character before the <code># @mcp.tool()</code> decorator to enable the semantic search mcp tool.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># @mcp.tool()</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">semantic_search_products</span><span class="p">(</span>
    <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span>
    <span class="n">query_description</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Field</span><span class="p">(</span>
    <span class="o">...</span>
</code></pre></div>
<p>After enabling the decorator, the method should look like this:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">()</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">semantic_search_products</span><span class="p">(</span>
    <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span>
    <span class="n">query_description</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Field</span><span class="p">(</span>
    <span class="o">...</span>
</code></pre></div>
<details class="note">
<summary>ðŸš€ For Developers: Set a breakpoint in the semantic search method and debug</summary>
<p><strong>Prerequisites:</strong> These instructions assume you're familiar with setting breakpoints in VS Code. If you need help with this, see the <a href="https://code.visualstudio.com/docs/debugtest/debugging#_breakpoints" target="_blank">VS Code documentation on breakpoints</a>.</p>
<p><strong>Purpose:</strong> Setting a breakpoint in the <code>semantic_search_products</code> method lets you observe exactly how the semantic search process works, including query processing and database interactions.</p>
<p><strong>Steps:</strong></p>
<ol>
<li>
<p><strong>Set the breakpoint:</strong> Click in the gutter (left margin) next to line 104, where you see <code>rls_user_id = get_rls_user_id(ctx)</code>. A red dot will appear, confirming the breakpoint is set.</p>
</li>
<li>
<p><strong>Debug and observe:</strong> When you run the agent app in debug mode, execution will pause at this breakpoint. You can then:</p>
</li>
<li>Inspect variable values</li>
<li>Step through the code line by line</li>
<li>Observe how the RLS user ID is extracted from the MCP request header</li>
<li>Watch the query get converted to a vector</li>
<li>See the semantic search execute against the PostgreSQL database</li>
</ol>
</details>
</li>
<li>
<p>Next, you need to enable the Agent instructions to use the semantic search tool. Switch back to the <code>app.py</code> file.</p>
</li>
<li>Scroll down to around line 30 and find the line <code># INSTRUCTIONS_FILE = "instructions/mcp_server_tools_with_semantic_search.txt"</code>.</li>
<li>
<p>Uncomment the line by removing the <code>#</code> at the beginning. This will enable the agent to use the semantic search tool.</p>
<div class="highlight"><pre><span></span><code><span class="n">INSTRUCTIONS_FILE</span> <span class="o">=</span> <span class="s2">&quot;instructions/mcp_server_tools_with_semantic_search.txt&quot;</span>
</code></pre></div>
</li>
</ol>
</div>
<div class="tabbed-block">
<h2 id="implement-semantic-search_1">Implement Semantic Search<a class="headerlink" href="#implement-semantic-search_1" title="Permanent link">&para;</a></h2>
<p>In this section, you will implement semantic search using the Model Context Protocol (MCP) to enhance the agent's capabilities.</p>
<ol>
<li>Open the <code>McpHost.cs</code> file from the <code>McpAgentWorkshop.McpServer</code> project.</li>
<li>
<p>Locate where the other MCP tools are registered with the MCP server, and register the <code>SemanticSearchTools</code> class as an MCP tool using <code>WithTools</code>:</p>
<div class="highlight"><pre><span></span><code><span class="p">.</span><span class="n">WithTools</span><span class="o">&lt;</span><span class="n">SemanticSearchTools</span><span class="o">&gt;</span><span class="p">();</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Note</p>
<p>Have a read of the implementation of <code>SemanticSearchTools</code> to learn how the MCP server will be performing the search.</p>
</div>
</li>
<li>
<p>Next, you need to enable the Agent instructions to use the semantic search tool. Switch back to the <code>AgentService</code> class and change the const <code>InstructionsFile</code> to <code>mcp_server_tools_with_semantic_search.txt</code>.</p>
</li>
</ol>
</div>
</div>
</div>
<h2 id="review-the-agent-instructions">Review the Agent Instructions<a class="headerlink" href="#review-the-agent-instructions" title="Permanent link">&para;</a></h2>
<ol>
<li>Press <kbd>F1</kbd> to open the VS Code Command Palette.</li>
<li>Type <strong>Open File</strong> and select <strong>File: Open File...</strong>.</li>
<li>Paste the following path into the file picker and press <kbd>Enter</kbd>:</li>
</ol>
<div class="highlight"><pre><span></span><code>/workspace/src/shared/instructions/mcp_server_tools_with_semantic_search.txt
</code></pre></div>
<ol>
<li>Review the instructions in the file. These instructions instruct the agent to use the semantic search tool to answer questions about sales data.</li>
</ol>
<h2 id="start-the-agent-app-with-the-semantic-search-tool">Start the Agent App with the Semantic Search Tool<a class="headerlink" href="#start-the-agent-app-with-the-semantic-search-tool" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Start</strong> the agent app by pressing <kbd>F5</kbd>. This will start the agent with the updated instructions and the semantic search tool enabled.</li>
<li>Open the <strong>Web Chat</strong> in your browser.</li>
<li>
<p>Enter the following question in the chat:</p>
<div class="highlight"><pre><span></span><code>What 18 amp circuit breakers do we sell?
</code></pre></div>
<p>The agent now understands the semantic meaning of the question and responds accordingly with relevant sales data.</p>
<div class="admonition info">
<p class="admonition-title">Note</p>
<p>The MCP Semantic Search tool works as follows:</p>
<ol>
<li>The question is converted into a vector using the same OpenAI embedding model (text-embedding-3-small) as the product descriptions.</li>
<li>This vector is used to search for similar product vectors in the PostgreSQL database.</li>
<li>The agent receives the results and uses them to generate a response.</li>
</ol>
</div>
</li>
</ol>
<h2 id="write-an-executive-report">Write an Executive Report<a class="headerlink" href="#write-an-executive-report" title="Permanent link">&para;</a></h2>
<p>The final prompt for this workshop is as follows:</p>
<div class="highlight"><pre><span></span><code>Write an executive report on the sales performance of different stores for these circuit breakers.
</code></pre></div>
<h2 id="leave-the-agent-app-running">Leave the Agent App Running<a class="headerlink" href="#leave-the-agent-app-running" title="Permanent link">&para;</a></h2>
<p>Leave the agent app running as you will use it in the next lab to explore secure agent data access.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../lab-2-start-the-agent/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Lab 2 Start your Agent">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Lab 2 Start your Agent
              </div>
            </div>
          </a>
        
        
          
          <a href="../observability-overview/" class="md-footer__link md-footer__link--next" aria-label="Next: Observability Overview">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Observability Overview
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 - present Microsoft

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.footer", "content.code.copy", "navigation.tabs.sticky", "content.tabs.link"], "search": "../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>